<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Information</title>
    <style>
        body { font-family: Arial, Helvetica, sans-serif; max-width: 720px; margin: 24px auto; padding: 0 16px; }
        h1 { margin-bottom: 8px; }
        label { margin-right: 6px; }
        input[type="text"] { padding: 6px 8px; margin: 4px 8px 12px 0; }
        input[type="submit"], input[type="button"] { padding: 6px 10px; margin-right: 8px; cursor: pointer; }
        ul { padding-left: 18px; }
        #message { color: #b00020; margin-top: 8px; }
        #searchResult { margin-top: 6px; }
        .muted { color: #666; }
    </style>
</head>

<body>
    <h1>Student Information</h1>

    <!-- Student Input -->
    <form id="studentForm" aria-labelledby="formTitle">
        <h2 id="formTitle" style="margin: 12px 0 8px;">Add a Student</h2>
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" placeholder="Enter full name" autocomplete="name" autofocus>
        <label for="roll">ID:</label>
        <input type="text" id="roll" name="roll" placeholder="Enter unique ID" inputmode="numeric">

        <input type="submit" id="stuinfo" value="Add Student">
        <input type="button" id="clearAll" value="Clear All">
    </form>

    <h3>Student List:</h3>
    <ul id="detail"></ul>

    <p id="count" class="muted"></p>
    <p id="message"></p>

    <!-- Search Feature -->
    <h3>Search Student by ID:</h3>
    <input type="text" id="searchId" placeholder="Enter ID">
    <input type="button" id="searchBtn" value="Search">
    <p id="searchResult"></p>

    <script>
        const students = [];
        const detail = document.getElementById('detail');
        const count = document.getElementById('count');
        const nameInput = document.getElementById('name');
        const idInput = document.getElementById('roll');
        const message = document.getElementById('message');

        function saveStudents() {
            try {
                localStorage.setItem('task9_students', JSON.stringify(students));
            } catch (err) {
                console.error(err);
            }
        }

        function loadStudents() {
            try {
                const raw = localStorage.getItem('task9_students');
                if (!raw) return;
                const parsed = JSON.parse(raw);
                if (Array.isArray(parsed)) {
                    parsed.forEach(stu => {
                        if (stu && typeof stu === 'object' && 'Name' in stu && 'ID' in stu) {
                            students.push({ Name: String(stu.Name), ID: String(stu.ID) });
                        }
                    });
                }
            } catch (err) {
                console.error(err);
            }
        }

        function renderStudents() {
            detail.innerHTML = '';
            students.forEach((stu, index) => {
                const li = document.createElement('li');
                const text = document.createElement('span');
                text.textContent = `Name: ${stu.Name}, ID: ${stu.ID}`;
                const delBtn = document.createElement('button');
                delBtn.type = 'button';
                delBtn.textContent = 'Delete';
                delBtn.style.marginLeft = '8px';
                delBtn.addEventListener('click', () => {
                    students.splice(index, 1);
                    saveStudents();
                    renderStudents();
                });
                li.appendChild(text);
                li.appendChild(delBtn);
                detail.appendChild(li);
            });
            count.textContent = `Total Students: ${students.length}`;
        }

        // Add Student (form submit)
        document.getElementById('studentForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const name = nameInput.value.replace(/\s+/g, ' ').trim();
            const id = idInput.value.trim();

            if (name === "" || id === "") {
                alert("Please enter both Name and ID.");
                return;
            }

            if (students.some(stu => stu.ID === id)) {
                message.textContent = "This ID already exists. Please enter a unique ID.";
                idInput.focus();
                return;
            }

            students.push({ Name: name, ID: id });
            saveStudents();
            renderStudents();

            nameInput.value = "";
            idInput.value = "";
            message.textContent = "";
            nameInput.focus();
        });

        // Clear message when user edits inputs
        [nameInput, idInput].forEach(el => {
            el.addEventListener('input', () => {
                message.textContent = '';
            });
        });

        // Clear All
        document.getElementById('clearAll').addEventListener('click', () => {
            students.length = 0;
            detail.innerHTML = "";
            count.textContent = "Total Students: 0";
            message.textContent = "";
            document.getElementById('searchResult').textContent = "";
            document.getElementById('searchId').value = "";
            nameInput.focus();
            try { localStorage.removeItem('task9_students'); } catch (err) { console.error(err); }
        });

        // Search by ID
        document.getElementById('searchBtn').addEventListener('click', () => {
            const searchId = document.getElementById('searchId').value.trim();
            const result = document.getElementById('searchResult');

            if (searchId === "") {
                result.textContent = "Enter an ID to search.";
                return;
            }

            const found = students.find(stu => stu.ID === searchId);

            if (found) {
                result.textContent = `Found: Name = ${found.Name}, ID = ${found.ID}`;
            } else {
                result.textContent = "No student found with this ID.";
            }
        });

        // Initialize
        loadStudents();
        renderStudents();
    </script>
</body>

</html>
